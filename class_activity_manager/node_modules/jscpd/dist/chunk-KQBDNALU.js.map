{"version":3,"sources":["/Users/Andrii_Kucherenko/Workspace/lab/jscpd/apps/jscpd/dist/chunk-KQBDNALU.js","../src/index.ts","../src/init/cli.ts","../src/init/options.ts","../src/init/ignore.ts","../src/options.ts","../src/print/files.ts","../src/print/options.ts","../src/print/supported-format.ts","../src/init/store.ts","../src/init/reporters.ts","../src/init/subscribers.ts","../src/init/hooks.ts"],"names":[],"mappings":"AAAA,irBAAI,UAAU,kBAAkB,CAAC,CAAC,CAAC,EAAE,GAAG,OAAO,QAAQ,IAAI,YAAY,EAAE,QAAQ,EAAE,OAAO,MAAM,IAAI,YAAY,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE;AAC/H,EAAE,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,OAAO,QAAQ,IAAI,YAAY,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC;AACjE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,EAAE;AACpB,EAAE,GAAG,CAAC,OAAO,QAAQ,IAAI,WAAW,EAAE,OAAO,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC;AAC3E,EAAE,MAAM,KAAK,CAAC,uBAAuB,EAAE,EAAE,EAAE,oBAAoB,CAAC;AAChE,CAAC,CAAC;AACF;AACA;ACPA,mCAAgF;AAChF,mCAA6B;AAC7B,uCAAoE;ADSpE;AACA;AEZA,sCAAsB;AACtB;AAEO,SAAS,OAAA,CAAQ,WAAA,EAAkB,IAAA,EAAyB;AAClE,EAAA,MAAM,IAAA,EAAM,IAAI,uBAAA,CAAQ,WAAA,CAAY,IAAI,CAAA;AAExC,EAAA,GAAA,CAAI,OAAA,CAAQ,WAAA,CAAY,OAAO,CAAA,CAC7B,KAAA,CAAM,sBAAsB,CAAA,CAC5B,WAAA,CAAY,WAAA,CAAY,WAAW,CAAA,CACnC,MAAA;AAAA,IACA,0BAAA;AAAA,IACA,qDAAA,EAAuD,6BAAA,UAAoB,EAAA,EAAI;AAAA,EAChF,CAAA,CACC,MAAA;AAAA,IACA,2BAAA;AAAA,IACA,sDAAA,EAAwD,6BAAA,WAAqB,EAAA,EAAI;AAAA,EAClF,CAAA,CACC,MAAA,CAAO,0BAAA,EAA4B,2CAAA,EAA6C,6BAAA,UAAoB,EAAA,EAAI,GAAG,CAAA,CAC3G,MAAA;AAAA,IACA,yBAAA;AAAA,IACA,sEAAA,EAAwE,6BAAA,SAAmB,EAAA,EAAI;AAAA,EAChG,CAAA,CACC,MAAA;AAAA,IACA,0BAAA;AAAA,IACA;AAAA,EACD,CAAA,CACC,MAAA,CAAO,uBAAA,EAAyB,wDAAwD,CAAA,CACxF,MAAA,CAAO,uBAAA,EAAyB,2EAA2E,CAAA,CAC3G,MAAA,CAAO,2BAAA,EAA6B,iDAAiD,CAAA,CACrF,MAAA;AAAA,IACA,0BAAA;AAAA,IACA;AAAA,EACD,CAAA,CACC,MAAA,CAAO,uBAAA,EAAyB,yCAAyC,CAAA,CACzE,MAAA;AAAA,IACA,qBAAA;AAAA,IACA,8EAAA,EAAgF,6BAAA,MAAgB,EAAA,EAAI;AAAA,EACrG,CAAA,CACC,MAAA,CAAO,uBAAA,EAAyB,sEAAsE,CAAA,CACtG,MAAA,CAAO,wBAAA,EAA0B,gDAAgD,CAAA,CACjF,MAAA,CAAO,aAAA,EAAe,wEAAwE,CAAA,CAC9F,MAAA,CAAO,cAAA,EAAgB,yDAAyD,CAAA,CAChF,MAAA,CAAO,kBAAA,EAAoB,0EAA0E,CAAA,CACrG,MAAA,CAAO,gBAAA,EAAkB,8BAA8B,CAAA,CACvD,MAAA,CAAO,kBAAA,EAAoB,0CAA0C,CAAA,CACrE,MAAA,CAAO,cAAA,EAAgB,+CAA+C,CAAA,CACtE,MAAA,CAAO,iBAAA,EAAmB,uCAAuC,CAAA,CACjE,MAAA,CAAO,yBAAA,EAA2B,kEAAkE,CAAA,CACpG,MAAA,CAAO,aAAA,EAAe,oFAAoF,CAAA,CAC1G,MAAA,CAAO,eAAA,EAAiB,gDAAgD,CAAA,CACxE,MAAA,CAAO,QAAA,EAAU,sCAAsC,CAAA,CACvD,MAAA,CAAO,aAAA,EAAe,0EAA0E,CAAA,CAC9F,MAAA,CAAO,qBAAA,EAAuB,sDAAsD,CAAA;AAExF,EAAA,GAAA,CAAI,KAAA,CAAM,IAAI,CAAA;AACd,EAAA,OAAO,GAAA;AACR;AFjBA;AACA;AGvCA;AACA,6CAAkC;AHyClC;AACA;AI3CA,wBAAyB;AAEzB,IAAM,gBAAA,EAAkB,SAAA,CAAQ,mBAAmB,CAAA;AAE5C,SAAS,UAAA,CAAW,OAAA,EAA6B;AACvD,EAAA,MAAM,OAAA,EAAmB,OAAA,CAAQ,OAAA,GAAU,CAAC,CAAA;AAE5C,EAAA,GAAA,CAAI,OAAA,CAAQ,UAAA,GAAa,4BAAA,OAAW,CAAQ,GAAA,CAAI,EAAA,EAAI,aAAa,CAAA,EAAG;AACnE,IAAA,IAAI,kBAAA,EAA8B,eAAA,CAAgB,OAAA,CAAQ,GAAA,CAAI,EAAA,EAAI,aAAa,EAAA,GAAK,CAAC,CAAA;AACrF,IAAA,kBAAA,EAAoB,iBAAA,CAAkB,GAAA;AAAA,MAAI,CAAC,OAAA,EAAA,GAC1C,OAAA,CAAQ,MAAA,CAAO,OAAA,CAAQ,OAAA,EAAS,CAAC,EAAA,IAAM,IAAA,EAAM,CAAA,EAAA;AAC9C,IAAA;AACgC,IAAA;AACgB,IAAA;AACjD,EAAA;AACO,EAAA;AACR;AJ0CiE;AACA;AK3DZ;AAC5B;AAEE;AACe;AACL;AAEwC;AAElD,EAAA;AAChB,IAAA;AACT,EAAA;AAE+B,EAAA;AACtB,IAAA;AACT,EAAA;AAGkD,EAAA;AAC1B,EAAA;AAE0B,EAAA;AACd,EAAA;AAC3B,IAAA;AACT,EAAA;AAEO,EAAA;AACT;AAEiE;AAC7B,EAAA;AACqB,IAAA;AACH,IAAA;AACA,IAAA;AACrC,IAAA;AACF,IAAA;AACA,IAAA;AACE,IAAA;AACI,IAAA;AACL,IAAA;AACD,IAAA;AACE,IAAA;AACF,IAAA;AACC,IAAA;AACA,IAAA;AACuC,IAAA;AACzC,IAAA;AACA,IAAA;AACI,IAAA;AACE,IAAA;AACD,IAAA;AACC,IAAA;AACD,IAAA;AACD,IAAA;AAChB,EAAA;AAEiC,EAAA;AACQ,IAAA;AACzC,EAAA;AAEmB,EAAA;AACyB,IAAA;AAC5C,EAAA;AAEgB,EAAA;AACsB,IAAA;AACtC,EAAA;AACgB,EAAA;AACsB,IAAA;AACtC,EAAA;AACqB,EAAA;AAC+B,IAAA;AACpD,EAAA;AAC2D,EAAA;AAE7B,EAAA;AACd,IAAA;AAChB,EAAA;AAEqC,EAAA;AACK,IAAA;AACrB,MAAA;AACnB,IAAA;AACD,EAAA;AAEM,EAAA;AACT;AAE0E;AACV,EAAA;AACpB,EAAA;AACxB,EAAA;AACoC,IAAA;AAChB,IAAA;AACnB,IAAA;AACoD,MAAA;AACrE,IAAA;AACmB,IAAA;AACsC,MAAA;AACzD,IAAA;AACO,IAAA;AACT,EAAA;AACQ,EAAA;AACV;AAEuD;AACC,EAAA;AAC9B,EAAA;AACU,IAAA;AACA,IAAA;AACG,IAAA;AAC+B,MAAA;AAClE,IAAA;AACqC,IAAA;AAC4B,MAAA;AACjE,IAAA;AAC+C,IAAA;AACjD,EAAA;AACQ,EAAA;AACV;AAEuD;AAEY,EAAA;AACE,EAAA;AAEN,EAAA;AAEpC,EAAA;AAEF,IAAA;AAClB,IAAA;AACA,IAAA;AACA,IAAA;AACL,EAAA;AACwC,EAAA;AACA,EAAA;AAErB,EAAA;AAEd,IAAA;AAC2C,MAAA;AAE5B,IAAA;AACpB,EAAA;AAEoC,EAAA;AACkB,IAAA;AACtD,EAAA;AAEO,EAAA;AACT;ALkCiE;AACA;AGrLN;AACd,EAAA;AAEW,EAAA;AAEb,EAAA;AAEP,EAAA;AAE5B,EAAA;AACR;AHmLiE;AACA;AMpMxC;AAGmC;AAChB,EAAA;AACd,IAAA;AAC5B,EAAA;AACyD,EAAA;AAC3D;ANoMiE;AACA;AO5MvC;AAE4B;AACjB,EAAA;AAChB,EAAA;AACrB;AP6MiE;AACA;AQpNvC;AACQ;AAEW;AACE,EAAA;AACF,EAAA;AAC9B,EAAA;AACf;ARqNiE;AACA;ACxNtC;AD0NsC;AACA;AShOpB;AAC3B;AAEyD;AAC1D,EAAA;AAC+B,IAAA;AACxC,IAAA;AACiC,MAAA;AAClB,MAAA;AACP,IAAA;AACoC,MAAA;AAChD,IAAA;AACF,EAAA;AACkC,EAAA;AACpC;ATiOiE;AACA;ACzOnC;AD2OmC;AACA;AUnPjE;AACE;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACK;AAEoB;AACF;AACC;AAGa;AAChC,EAAA;AACC,EAAA;AACD,EAAA;AACK,EAAA;AACG,EAAA;AACP,EAAA;AACG,EAAA;AACD,EAAA;AACG,EAAA;AACJ,EAAA;AACA,EAAA;AACT;AAEsF;AAGpC,EAAA;AACnB,IAAA;AACiC,MAAA;AACrD,IAAA;AACD,MAAA;AAC8C,QAAA;AACI,QAAA;AAC1C,MAAA;AACN,QAAA;AAC6C,UAAA;AACK,UAAA;AAC1C,QAAA;AAC6B,UAAA;AACH,UAAA;AACtC,QAAA;AACF,MAAA;AACF,IAAA;AACD,EAAA;AACH;AV8OiE;AACA;AWpSI;AAGmB;AACjE,EAAA;AACuC,IAAA;AAC5D,EAAA;AAEqB,EAAA;AACwC,IAAA;AAC7D,EAAA;AACF;AXmSiE;AACA;AY/SR;AAGyB;AACvC,EAAA;AACtB,EAAA;AACqB,IAAA;AACxC,EAAA;AACF;AZ+SiE;AACA;AC7StC;AAEP;AAEiG;AAChD,EAAA;AACZ,EAAA;AAEG,EAAA;AACV,EAAA;AACK,IAAA;AACrD,EAAA;AAC+C,EAAA;AACwB,EAAA;AACvC,EAAA;AACA,EAAA;AAC8B,EAAA;AAE3B,EAAA;AACE,EAAA;AACN,EAAA;AAEV,EAAA;AACmB,IAAA;AACxC,EAAA;AACyD,EAAA;AAClC,IAAA;AACsB,MAAA;AAC3C,IAAA;AACO,IAAA;AACR,EAAA;AACH;AAEiF;AAElC,EAAA;AAER,EAAA;AAEW,EAAA;AAE9B,EAAA;AACK,IAAA;AACvB,EAAA;AAEmB,EAAA;AACG,IAAA;AACtB,EAAA;AAEgD,EAAA;AACjB,IAAA;AAC/B,EAAA;AAEmB,EAAA;AACyC,IAAA;AAC1C,IAAA;AACS,IAAA;AACpB,EAAA;AAC+B,IAAA;AAEhB,IAAA;AACO,MAAA;AACe,wBAAA;AACtC,MAAA;AACO,MAAA;AAEM,IAAA;AACD,MAAA;AACb,IAAA;AACL,EAAA;AACF;ADgSiE;AACA;AACA;AACA;AACA","file":"/Users/Andrii_Kucherenko/Workspace/lab/jscpd/apps/jscpd/dist/chunk-KQBDNALU.js","sourcesContent":[null,"import {getDefaultOptions, IClone, IMapFrame, IOptions, IStore, Statistic} from '@jscpd/core';\nimport { grey, italic } from 'colors/safe';\nimport { EntryWithContent, getFilesToDetect, InFilesDetector } from '@jscpd/finder';\nimport { initCli, initOptionsFromCli } from './init';\nimport { printFiles, printOptions, printSupportedFormat } from './print';\nimport { createHash } from \"crypto\";\nimport { getStore } from './init/store';\nimport { getSupportedFormats, Tokenizer } from '@jscpd/tokenizer';\nimport { registerReporters } from './init/reporters';\nimport { registerSubscribers } from './init/subscribers';\nimport { registerHooks } from './init/hooks';\nimport {readJSONSync} from \"fs-extra\";\n\nconst TIMER_LABEL = 'Detection time:';\n\nexport const detectClones = (opts: IOptions, store: IStore<IMapFrame> | undefined = undefined): Promise<IClone[]> => {\n  const options: Partial<IOptions> = {...getDefaultOptions(), ...opts};\n  options.format = options.format || getSupportedFormats();\n\n  const files: EntryWithContent[] = getFilesToDetect(options);\n  const hashFunction = (value: string): string => {\n    return createHash('md5').update(value).digest('hex')\n  }\n  options.hashFunction = options.hashFunction || hashFunction;\n  const currentStore: IStore<IMapFrame> = store || getStore(options.store);\n  const statistic = new Statistic();\n  const tokenizer = new Tokenizer();\n  const detector = new InFilesDetector(tokenizer, currentStore, statistic, options);\n\n  registerReporters(options, detector);\n  registerSubscribers(options, detector);\n  registerHooks(options, detector);\n\n  if (!options.silent) {\n    console.time(italic(grey(TIMER_LABEL)));\n  }\n  return detector.detect(files).then((clones: IClone[]) => {\n    if (!options.silent) {\n      console.timeEnd(italic(grey(TIMER_LABEL)));\n    }\n    return clones;\n  });\n}\n\nexport async function jscpd(argv: string[], exitCallback?: (code: number) => {}) {\n\n  const packageJson = readJSONSync(__dirname + '/../package.json');\n\n  const cli = initCli(packageJson, argv);\n\n  const options: IOptions = initOptionsFromCli(cli);\n\n  if (options.list) {\n    printSupportedFormat();\n  }\n\n  if (options.debug) {\n    printOptions(options);\n  }\n\n  if (!options.path || options.path.length === 0) {\n    options.path = [process.cwd()];\n  }\n\n  if (options.debug) {\n    const files: EntryWithContent[] = getFilesToDetect(options);\n    printFiles(files);\n    return Promise.resolve([]);\n  } else {\n    const store = getStore(options.store);\n    return detectClones(options, store)\n      .then((clones) => {\n        if (clones.length > 0) {\n          exitCallback?.(options.exitCode || 0)\n        }\n        return clones;\n      })\n      .finally(() => {\n        store.close();\n      });\n  }\n}\n\n","import {Command} from 'commander';\nimport {getOption} from '@jscpd/core';\n\nexport function initCli(packageJson: any, argv: string[]): Command {\n\tconst cli = new Command(packageJson.name);\n\n\tcli.version(packageJson.version)\n\t\t.usage('[options] <path ...>')\n\t\t.description(packageJson.description)\n\t\t.option(\n\t\t\t'-l, --min-lines [number]',\n\t\t\t'min size of duplication in code lines (Default is ' + getOption('minLines') + ')',\n\t\t)\n\t\t.option(\n\t\t\t'-k, --min-tokens [number]',\n\t\t\t'min size of duplication in code tokens (Default is ' + getOption('minTokens') + ')',\n\t\t)\n\t\t.option('-x, --max-lines [number]', 'max size of source in lines (Default is ' + getOption('maxLines') + ')')\n\t\t.option(\n\t\t\t'-z, --max-size [string]',\n\t\t\t'max size of source in bytes, examples: 1kb, 1mb, 120kb (Default is ' + getOption('maxSize') + ')',\n\t\t)\n\t\t.option(\n\t\t\t'-t, --threshold [number]',\n\t\t\t'threshold for duplication, in case duplications >= threshold jscpd will exit with error',\n\t\t)\n\t\t.option('-c, --config [string]', 'path to config file (Default is .jscpd.json in <path>)')\n\t\t.option('-i, --ignore [string]', 'glob pattern for files what should be excluded from duplication detection')\n\t\t.option('--ignore-pattern [string]', 'Ignore code blocks matching the regexp patterns')\n\t\t.option(\n\t\t\t'-r, --reporters [string]',\n\t\t\t'reporters or list of reporters separated with comma to use (Default is time,console)',\n\t\t)\n\t\t.option('-o, --output [string]', 'reporters to use (Default is ./report/)')\n\t\t.option(\n\t\t\t'-m, --mode [string]',\n\t\t\t'mode of quality of search, can be \"strict\", \"mild\" and \"weak\" (Default is \"' + getOption('mode') + '\")',\n\t\t)\n\t\t.option('-f, --format [string]', 'format or formats separated by comma (Example php,javascript,python)')\n\t\t.option('-p, --pattern [string]', 'glob pattern to file search (Example **/*.txt)')\n\t\t.option('-b, --blame', 'blame authors of duplications (get information about authors from git)')\n\t\t.option('-s, --silent', 'do not write detection progress and result to a console')\n\t\t.option('--store [string]', 'use for define custom store (e.g. --store leveldb used for big codebase)')\n\t\t.option('-a, --absolute', 'use absolute path in reports')\n\t\t.option('-n, --noSymlinks', 'dont use symlinks for detection in files')\n\t\t.option('--ignoreCase', 'ignore case of symbols in code (experimental)')\n\t\t.option('-g, --gitignore', 'ignore all files from .gitignore file')\n\t\t.option('--formats-exts [string]', 'list of formats with file extensions (javascript:es,es6;dart:dt)')\n\t\t.option('-d, --debug', 'show debug information, not run detection process(options list and selected files)')\n\t\t.option('-v, --verbose', 'show full information during detection process')\n\t\t.option('--list', 'show list of total supported formats')\n\t\t.option('--skipLocal', 'skip duplicates in local folders, just detect cross folders duplications')\n    .option('--exitCode [number]', 'exit code to use when code duplications are detected')\n\n\tcli.parse(argv);\n\treturn cli as Command;\n}\n","import {Command} from 'commander';\nimport {getModeHandler, IOptions} from '@jscpd/core';\nimport {getSupportedFormats} from '@jscpd/tokenizer';\nimport {initIgnore} from './ignore';\nimport {prepareOptions} from '../options';\n\nexport function initOptionsFromCli(cli: Command): IOptions {\n\tconst options: IOptions = prepareOptions(cli);\n\n\toptions.format = options.format || getSupportedFormats();\n\n\toptions.mode = getModeHandler(options.mode);\n\n\toptions.ignore = initIgnore(options);\n\n\treturn options;\n}\n","import {IOptions} from '@jscpd/core';\nimport {existsSync} from \"fs\";\n\nconst gitignoreToGlob = require('gitignore-to-glob');\n\nexport function initIgnore(options: IOptions): string[] {\n\tconst ignore: string[] = options.ignore || [];\n\n\tif (options.gitignore && existsSync(process.cwd() + '/.gitignore')) {\n\t\tlet gitignorePatterns: string[] = gitignoreToGlob(process.cwd() + '/.gitignore') || [];\n\t\tgitignorePatterns = gitignorePatterns.map((pattern) =>\n\t\t\tpattern.substr(pattern.length - 1) === '/' ? `${pattern}**/*` : pattern,\n\t\t);\n\t\tignore.push(...gitignorePatterns);\n\t\tignore.map((pattern) => pattern.replace('!', ''));\n\t}\n\treturn ignore;\n}\n","// @ts-nocheck\nimport {dirname, resolve, isAbsolute, relative} from \"path\";\nimport {existsSync} from \"fs\";\nimport {Command} from 'commander';\nimport {readJSONSync} from 'fs-extra';\nimport {getDefaultOptions, IOptions} from '@jscpd/core';\nimport {parseFormatsExtensions} from '@jscpd/finder';\n\nconst resolveIgnorePattern = (configDir: string, pattern: string): string => {\n  // Don't modify if pattern is already absolute\n  if (isAbsolute(pattern)) {\n    return pattern;\n  }\n  // Don't modify if pattern starts with ** (meant to match at any depth)\n  if (pattern.startsWith('**/')) {\n    return pattern;\n  }\n  // For relative patterns, we need to adjust them to be relative to cwd\n  // instead of the config directory\n  const absolutePattern = resolve(configDir, pattern);\n  const cwd = process.cwd();\n  // If the config is in cwd or a subdirectory of cwd, make pattern relative to cwd\n  const relativePath = relative(cwd, absolutePattern);\n  if (!relativePath.startsWith('..')) {\n    return relativePath;\n  }\n  // Otherwise return as absolute\n  return absolutePattern;\n};\n\nconst convertCliToOptions = (cli: Command): Partial<IOptions> => {\n  const result: Partial<IOptions> = {\n    minTokens: cli.minTokens ? parseInt(cli.minTokens) : undefined,\n    minLines: cli.minLines ? parseInt(cli.minLines) : undefined,\n    maxLines: cli.maxLines ? parseInt(cli.maxLines) : undefined,\n    maxSize: cli.maxSize,\n    debug: cli.debug,\n    store: cli.store,\n    pattern: cli.pattern,\n    executionId: cli.executionId,\n    silent: cli.silent,\n    blame: cli.blame,\n    verbose: cli.verbose,\n    cache: cli.cache,\n    output: cli.output,\n    format: cli.format,\n    formatsExts: parseFormatsExtensions(cli.formatsExts),\n    list: cli.list,\n    mode: cli.mode,\n    absolute: cli.absolute,\n    noSymlinks: cli.noSymlinks,\n    skipLocal: cli.skipLocal,\n    ignoreCase: cli.ignoreCase,\n    gitignore: cli.gitignore,\n    exitCode: cli.exitCode,\n  };\n\n  if (cli.threshold !== undefined) {\n    result.threshold = Number(cli.threshold);\n  }\n\n  if (cli.reporters) {\n    result.reporters = cli.reporters.split(',');\n  }\n\n  if (cli.format) {\n    result.format = cli.format.split(',');\n  }\n  if (cli.ignore) {\n    result.ignore = cli.ignore.split(',');\n  }\n  if(cli.ignorePattern){\n    result.ignorePattern = cli.ignorePattern.split(',');\n  }\n  result.path = cli.path ? [cli.path].concat(cli.args) : cli.args;\n\n  if (result.path.length === 0) {\n    delete result.path;\n  }\n\n  Object.keys(result).forEach((key) => {\n    if (typeof result[key] === 'undefined') {\n      delete result[key];\n    }\n  });\n\n  return result;\n}\n\nconst readConfigJson = (config: string | undefined): Partial<IOptions> => {\n  const configFile: string = config ? resolve(config) : resolve('.jscpd.json');\n  const configExists = existsSync(configFile);\n  if (configExists) {\n    const result = {config: configFile, ...readJSONSync(configFile)};\n    const configDir = dirname(configFile);\n    if (result.path) {\n      result.path = result.path.map((path: string) => resolve(configDir, path));\n    }\n    if (result.ignore) {\n      result.ignore = result.ignore.map((pattern: string) => resolveIgnorePattern(configDir, pattern));\n    }\n    return result;\n  }\n  return {};\n}\n\nconst readPackageJsonConfig = (): Partial<IOptions> => {\n  const config = resolve(process.cwd() + '/package.json');\n  if (existsSync(config)) {\n    const json = readJSONSync(config);\n    const configDir = dirname(config);\n    if (json.jscpd && json.jscpd.path) {\n      json.jscpd.path = json.jscpd.path.map((path: string) => resolve(configDir, path));\n    }\n    if (json.jscpd && json.jscpd.ignore) {\n      json.jscpd.ignore = json.jscpd.ignore.map((pattern: string) => resolveIgnorePattern(configDir, pattern));\n    }\n    return json.jscpd ? {config, ...json.jscpd} : {};\n  }\n  return {};\n}\n\nexport function prepareOptions(cli: Command): IOptions {\n  // @ts-ignore\n  const storedConfig: Partial<IOptions> = readConfigJson(cli.config);\n  const packageJsonConfig: Partial<IOptions> = readPackageJsonConfig();\n\n  const argsConfig: Partial<IOptions> = convertCliToOptions(cli);\n\n  const result: IOptions = {\n\n    ...getDefaultOptions(),\n    ...packageJsonConfig,\n    ...storedConfig,\n    ...argsConfig,\n  };\n  result.reporters = result.reporters || [];\n  result.listeners = result.listeners || [];\n\n  if (result.silent) {\n    result.reporters = result.reporters\n      .filter(\n        (reporter) => !reporter.includes('console'),\n      )\n      .concat('silent');\n  }\n\n  if (result.threshold !== undefined) {\n    result.reporters = [...result.reporters, 'threshold'];\n  }\n\n  return result;\n}\n","import {bold, grey} from 'colors/safe';\nimport {EntryWithContent} from '@jscpd/finder';\n\nexport function printFiles(files: EntryWithContent[]): void {\n\tfiles.forEach((stats: EntryWithContent) => {\n\t\tconsole.log(grey(stats.path));\n\t});\n\tconsole.log(bold(`Found ${files.length} files to detect.`));\n}\n","import {IOptions} from '@jscpd/core';\nimport {bold, white} from 'colors/safe';\n\nexport function printOptions(options: IOptions): void {\n  console.log(bold(white('Options:')));\n  console.dir(options);\n}\n","import {bold, white} from 'colors/safe';\nimport {getSupportedFormats} from '@jscpd/tokenizer';\n\nexport function printSupportedFormat(): void {\n\tconsole.log(bold(white('Supported formats: ')));\n\tconsole.log(getSupportedFormats().join(', '));\n\tprocess.exit(0);\n}\n","import {IMapFrame, IStore, MemoryStore} from '@jscpd/core';\nimport {red} from 'colors/safe';\n\nexport function getStore(storeName: string | undefined): IStore<IMapFrame> {\n  if (storeName) {\n    const packageName = '@jscpd/' + storeName + '-store';\n    try {\n      const store = require(packageName).default;\n      return new store();\n    } catch (e) {\n      console.error(red('store name ' + storeName + ' not installed.'))\n    }\n  }\n  return new MemoryStore<IMapFrame>();\n}\n","import {\n  ConsoleFullReporter,\n  ConsoleReporter,\n  CSVReporter,\n  InFilesDetector,\n  JsonReporter,\n  MarkdownReporter,\n  SilentReporter,\n  ThresholdReporter,\n  XcodeReporter,\n  XmlReporter,\n} from '@jscpd/finder';\nimport {IOptions} from '@jscpd/core';\nimport {grey, yellow} from 'colors/safe';\nimport HtmlReporter from \"@jscpd/html-reporter\";\nimport SarifReporter from \"jscpd-sarif-reporter\";\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst reporters: Record<string, any> = {\n  xml: XmlReporter,\n  json: JsonReporter,\n  csv: CSVReporter,\n  markdown: MarkdownReporter,\n  consoleFull: ConsoleFullReporter,\n  html: HtmlReporter,\n  console: ConsoleReporter,\n  silent: SilentReporter,\n  threshold: ThresholdReporter,\n  xcode: XcodeReporter,\n  sarif: SarifReporter,\n}\n\nexport function registerReporters(options: IOptions, detector: InFilesDetector): void {\n\n  // @ts-ignore\n  options.reporters.forEach((reporter: string) => {\n    if (reporter in reporters) {\n      detector.registerReporter(new reporters[reporter](options));\n    } else {\n      try {\n        const reporterClass = require(`@jscpd/${reporter}-reporter`).default;\n        detector.registerReporter(new reporterClass(options));\n      } catch (e) {\n        try {\n          const reporterClass = require(`jscpd-${reporter}-reporter`).default;\n          detector.registerReporter(new reporterClass(options));\n        } catch (e) {\n          console.log(yellow(`warning: ${reporter} not installed (install packages named @jscpd/${reporter}-reporter or jscpd-${reporter}-reporter)`))\n          console.log(grey((e as any).message));\n        }\n      }\n    }\n  });\n}\n","import {InFilesDetector, ProgressSubscriber, VerboseSubscriber} from '@jscpd/finder';\nimport {IOptions} from '@jscpd/core';\n\nexport function registerSubscribers(options: IOptions, detector: InFilesDetector): void {\n  if (options.verbose) {\n    detector.registerSubscriber(new VerboseSubscriber(options));\n  }\n\n  if (!options.silent) {\n    detector.registerSubscriber(new ProgressSubscriber(options));\n  }\n}\n","import {BlamerHook, FragmentsHook, InFilesDetector} from '@jscpd/finder';\nimport {IOptions} from '@jscpd/core';\n\nexport function registerHooks(options: IOptions, detector: InFilesDetector): void {\n  detector.registerHook(new FragmentsHook());\n  if (options.blame) {\n    detector.registerHook(new BlamerHook());\n  }\n}\n"]}