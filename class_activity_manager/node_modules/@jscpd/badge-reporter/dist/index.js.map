{"version":3,"sources":["/Users/Andrii_Kucherenko/Workspace/lab/jscpd/packages/badge-reporter/dist/index.js","../src/index.ts"],"names":[],"mappings":"AAAA;ACEA,gCAAqB;AACrB,4BAAmB;AACnB,mCAA2C;AAC3C,mCAAoB;AAEpB,IAAqB,cAAA,EAArB,MAAwD;AAAA,EACtD,WAAA,CAAoB,OAAA,EAAmB;AAAnB,IAAA,IAAA,CAAA,QAAA,EAAA,OAAA;AAAA,EACpB;AAAA;AAAA,EAGO,MAAA,CAAO,MAAA,EAAkB,SAAA,EAA6B;AAC3D,IAAA,MAAM,aAAA,EAAe,IAAA,CAAK,OAAA,CAAQ,iBAAA,EAAmB,IAAA,CAAK,OAAA,CAAQ,gBAAA,CAAiB,MAAA,GAAS,CAAC,EAAA,EAAI,CAAC,CAAA;AAClG,IAAA,GAAA,CAAI,IAAA,CAAK,OAAA,CAAQ,MAAA,EAAQ;AACvB,MAAA,MAAM,MAAA,EAAQ,4BAAA;AAAO,QACnB,KAAA,EAAO,IAAA,CAAK,QAAA,CAAS,SAAS,CAAA;AAAA,QAC9B,MAAA,EAAQ,IAAA,CAAK,SAAA,CAAU,SAAS,CAAA;AAAA,QAChC,OAAA,EAAS,YAAA;AAAA,QACT,GAAG;AAAA,MACL,CAAC,CAAA;AACD,MAAA,MAAM,KAAA,EAAO,YAAA,CAAa,KAAA,EAAO,YAAA,CAAa,KAAA,EAAO,wBAAA,IAAK,CAAK,OAAA,CAAQ,MAAA,EAAQ,iBAAiB,CAAA;AAChG,MAAA,oCAAA,IAAc,CAAK,OAAA,CAAQ,MAAM,CAAA;AACjC,MAAA,oCAAA,IAAc,EAAM,KAAK,CAAA;AACzB,MAAA,OAAA,CAAQ,GAAA,CAAI,yBAAA,CAAM,eAAA,EAAkB,IAAI,CAAA,CAAA;AAC1C,IAAA;AACF,EAAA;AAEgD,EAAA;AACX,IAAA;AACrC,EAAA;AAE+C,EAAA;AACH,IAAA;AACjC,MAAA;AACT,IAAA;AACyC,IAAA;AAC3C,EAAA;AACF;ADH+C;AACA;AACA","file":"/Users/Andrii_Kucherenko/Workspace/lab/jscpd/packages/badge-reporter/dist/index.js","sourcesContent":[null,"import {IClone, IOptions, IStatistic} from '@jscpd/core';\nimport {IReporter} from \"@jscpd/finder\";\nimport {badgen} from \"badgen\";\nimport {join} from 'path';\nimport {ensureDirSync, writeFileSync} from \"fs-extra\";\nimport {green} from \"colors/safe\";\n\nexport default class BadgeReporter implements IReporter {\n  constructor(private options: IOptions) {\n  }\n\n  // @ts-ignore\n  public report(clones: IClone[], statistic: IStatistic): void {\n    const badgeOptions = this.options.reportersOptions ? this.options.reportersOptions.badge || {} : {};\n    if (this.options.output) {\n      const badge = badgen({\n        color: this.getColor(statistic),\n        status: this.getStatus(statistic),\n        subject: 'Copy/Paste',\n        ...badgeOptions\n      });\n      const path = badgeOptions.path ? badgeOptions.path : join(this.options.output, 'jscpd-badge.svg');\n      ensureDirSync(this.options.output);\n      writeFileSync(path, badge);\n      console.log(green(`Badge saved to ${path}`));\n    }\n  }\n\n  public getStatus(statistic: IStatistic): string {\n    return statistic ? statistic.total.percentage + '%' : 'N/A'\n  }\n\n  public getColor(statistic: IStatistic): string {\n    if (this.options.threshold === undefined) {\n      return 'grey';\n    }\n    return statistic.total.percentage < this.options.threshold ? 'green' : 'red';\n  }\n}\n"]}